= WAS

* 웹 애플리케이션 서버(WAS)는 웹 서버와 데이터베이스 사이에서 동작하는 미들웨어로, 클라이언트의 요청을 받아 애플리케이션 로직을 실행하고 그 결과를 다시 웹 서버로 반환하는 역할을 합니다.

* (Servlet만 한정해서 보면) 흔히 WAS = Servlet Container라고 합니다.


== WAS ( Web Application Server ) ?

=== 주요 기능

* 동적 콘텐츠 제공
** WAS는 클라이언트의 요청을 처리하여 동적인 콘텐츠를 생성합니다. 애플리케이션 로직을 실행한 후 그 결과를 웹 서버로 반환합니다.
* 지원 기술
** **Java 서블릿**, **JSP(JavaServer Pages)**, EJB(Enterprise JavaBeans) 등의 기술을 지원합니다.

=== WAS의 주요 특징
* 확장성
** 많은 수의 동시 요청을 처리할 수 있습니다.
* 보안
** 인증, 권한 부여, 데이터 암호화 등의 보안 메커니즘을 제공합니다.
* 트랜잭션 관리
** 여러 작업에 걸쳐 데이터의 무결성과 일관성을 보장합니다.
* 자원 관리
** 데이터베이스 연결, 스레드 풀 등의 자원을 효율적으로 관리합니다.

=== WAS의 종류
* **Apache Tomcat**
** **apache 재단에서 개발한 무료 오픈 소스 WAS(Web Application Server)**
** Servlet Container의 reference 구현

* IBM WebSphere
* Oracle WebLogic
* JBoss EAP
* TMAX JEUS

== Servlet API

=== Servlet 이란?
* 서블릿(Servlet)은 자바 프로그래밍 언어로 작성된 클래스이며, 주로 웹 서버에서 동작하는 애플리케이션의 기능을 확장하기 위해 사용됩니다. 서블릿은 클라이언트의 요청을 받아 처리하고, 그 결과를 응답으로 반환하는 역할을 합니다

=== Servlet API

* Jakarta EE 에서는 Servlet API Spec 만 정의하고 실제 구현은 WAS에서 담당 합니다.
** 예) ServletRequest
*** Servlet API: jakarta.servlet.http.HttpServletRequest interface
*** tomcat 구현: org.apache.catalina.connector.Request class

* link:01.maven-scope.adoc[Maven scope, Servlet Api 참고]


== Servlet spec과 tomcat version

https://tomcat.apache.org/whichversion.html

|===
|Servlet Spec |플랫폼 버전 |최소 지원 tomat 버전 

|Servlet 6.0 |Jakarta EE 10 |tomcat 10.1 
|Servlet 5.0 |Jakarta EE 9 |tomcat 10.0 
|Servlet 4.0 |Jakarta EE 8 |tomcat 9.0 
|Servlet 4.0 |Java EE 8 |tomcat 9.0 
|Servlet 3.1 |Java EE 7 |tomcat 8.0 
|Servlet 3.0 |Java EE 6 |tomcat 7.0 
|===

== 정리

=== Servlet

* Java를 사용하여 동적 웹 콘텐츠를 생성하는 서버 측 프로그램
* CGI 단점 해결 → Servlet Container 도입

=== Servlet Container

* Servlet의 생명주기를 관리하고, URL과 특정 서블릿을 맵핑 하며 URL 요청 처리
* Java EE 아키텍처에 속함

=== Java EE

* Java 언어로 엔터프라이즈 애플리케이션을 개발하고 운영할 수 있도록 지원해 주는 플랫폼
* 현재는 Eclipse 재단으로 운영이 넘어가서 Jakarta EE 로 변경됨

=== WAS

* Web Application Server
* = Servlet Container

=== tomcat

* apache 재단에서 만든 WAS 중의 하나
* Servlet Container의 reference 구현
* 사실상, Servlet Container = WAS = tomcat

== 웹서버와 WAS 연동

=== Proxy

* 자원을 요청하는 클라이언트와
** 자원을 제공하는 서버 사이에서
** 중재자 역할을 하는 서버 프로그램

=== Forward Proxy

* 사용자의 요청을 실제 서버가 직접 받는 것이 아니라
** 중간에서 포워드 프락시 서버가 대신 요청받아 실제 서버에 연결하여 그 결과를 클라이언트에 전달(forward)
* Caching을 통한 성능 향상
* 웹 사용 환경 제한을 통한 보안 강화

image:./images/image.png[image.png]

=== Reverse Proxy

* 보안상의 이유로 DMZ 존에 웹서버를 두고 Reverse Proxy로 설정하고 WAS는 내부망에 위치시킴
* 상황에 맞게 웹서버나 WAS를 유연하게 늘릴 수 있음

image:./images/image-1.png[image.png]

== Nginx에 Tomcat 연동

* mac
** */usr/local/etc/nginx/servers*
* linux
** /etc/nginx/conf.d/
* 파일 생성

** servlet.com.conf

----
upstream tomcat {
    server 127.0.0.1:8080;
}

server {
    listen 80;
    server_name servlet.com;
    location / {
        proxy_set_header X-Forwarded-For $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Host $http_host;
        proxy_pass http://tomcat;
    }
}
----

* nginx restart

----
sudo brew services restart nginx
----

* hostname 변경
** sudo vi /etc/hosts (추가)

----
127.0.0.1       servlet.com
----

* http://servlet.com/hello

image:./images/image-2.png[image.png]